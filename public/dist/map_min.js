L.mapquest.key="nkL6LFerG2cvr74dIKmAFOfVpGn5ACIZ";const search_i_e=$("#search_i_map"),search_form_f_e=$("#search_form_f_map"),parse_address=a=>{console.log(a),$.get(`/api/parse/${a}`).then(function(a){const b=a;console.log(b.realtor),create_elements(b.realtor),console.log(b.chosenLocation.formattedAddress);const c=b.chosenLocation.street,d=b.chosenLocation.city,e=b.chosenLocation.state,f=b.chosenLocation.zipcode;console.log(c),console.log(d),console.log(e),console.log(f)})};function getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition):alert("Geolocation is not supported by this browser.")}function showPosition(a){var b=a.coords.latitude,c=a.coords.longitude;console.log("Your coordinates are Latitude: "+b+" Longitude "+c),get_city_from_coord(b,c)}function get_city_from_coord(a,b){var c=c;$.ajax({url:"https://nominatim.openstreetmap.org/reverse?format=json&lat="+a+"&lon="+b,method:"GET"}).then(function(a){var b=a.address.city,c=a.address.state;const d=b+" "+c;parse_address(d),L.mapquest.geocoding().geocode(d,createMap)})}const create_elements=a=>{const b=$("#search_box_results");b.attr("style","display: block"),a.listings.forEach(a=>{const c=$("<div>"),d=$("<p>"),e=$("<p>"),f=$("<p>"),g=$("<div>"),h=$("<img>");c.attr("id","search_results"),c.attr("data-name",a.address),h.attr("id","realtor_images"),g.attr("id","div_d"),h.attr("src",a.photo),d.attr("id","address_search"),e.attr("id","square_foot"),f.attr("id","bath"),d.text("Address "+a.address),e.text("Sqft "+a.sqft),f.text("Beds "+a.beds),g.append(d,e,f),c.append(g,h),b.append(c)})},createMap=(a,b)=>{var c=b.results[0].locations[0],d=c.displayLatLng,e=L.mapquest.map("map",{center:d,layers:L.mapquest.tileLayer("map"),zoom:18});e.addControl(L.mapquest.control());var f=L.popup();e.on("click",function(a){f.setLatLng(a.latlng).openOn(this),L.mapquest.geocoding().reverse(a.latlng,g)});const g=(a,b)=>{var c=b.results[0].locations[0],d=c.street,e=c.adminArea5,g=c.adminArea3;f.setContent(`${d}, ${e}, ${g} <p><a href="/write-review/${d}, ${e}, ${g}" id="write_rev" >Write Review</a></p> <p><a href="/get-review/${d}, ${e}, ${g}" >Get Review</a></p>`)};var h=window.location.pathname.split("/");let i=h[2].split("%20").join(" ");console.log(parse_address(i)),L.popup({closeButton:!1}).setLatLng(d).setContent(`${c.street}, ${c.adminArea5}, ${c.adminArea3} <p><a href="/write-review/${i}" id="write_rev"  >Write Review</a></p> <p><a href="/get-review/${i}">Get Review</a></p>`).openOn(e)},search=()=>{var a=window.location.pathname.split("/");let b=a[2].split("%20").join(" ");return"current_location"===b?getLocation():(parse_address(b),L.mapquest.geocoding().geocode(b,createMap)),b};search();const get_search_result=()=>{let a=search_i_e.val();console.log(a),window.open(`/map/${a}`,"_self")};search_form_f_e.on("submit",a=>{a.preventDefault(),get_search_result()}),$(document).on("click","#search_results",function(){const a=$(this).attr("data-name");console.log(a),$(this),copyToClipboard(a)});function copyToClipboard(a){$("<input>").val(a).appendTo("body").select();document.execCommand("copy")}